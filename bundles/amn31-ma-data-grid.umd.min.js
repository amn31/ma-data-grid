!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("jquery"),require("materialize-css"),require("@amn31/filter-multiple-conditions"),require("@angular/common"),require("@angular/forms")):"function"==typeof define&&define.amd?define("@amn31/ma-data-grid",["exports","@angular/core","jquery","materialize-css","@amn31/filter-multiple-conditions","@angular/common","@angular/forms"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).amn31=e.amn31||{},e.amn31["ma-data-grid"]={}),e.ng.core,e.$,e.M,e.filterMultipleConditions,e.ng.common,e.ng.forms)}(this,(function(e,t,i,a,r,n,o){"use strict";function l(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(i){if("default"!==i){var a=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:function(){return e[i]}})}})),t.default=e,Object.freeze(t)}var s=l(i),c=[{value:"1",operator:"=",label:"true"},{value:"0",operator:"=",label:"false"},{value:"a",operator:"isnull",label:"NULL"},{value:"a",operator:"isnotnull",label:"!NULL"}],p=[{value:"1",operator:"=",label:"true"},{value:"0",operator:"=",label:"false"}],d=[{value:"",operator:"",label:""},{value:"%${1}%",operator:"like",label:"contains"},{value:"%${1}%",operator:"not like",label:"without"},{value:"${1}%",operator:"like",label:"startswith"},{value:"${1}%",operator:"not like",label:"not start"},{value:"%${1}",operator:"like",label:"endswith"},{value:"%${1}",operator:"not like",label:"not end"}],h=[{value:"",operator:"",label:""},{value:"${1}",operator:"=",label:"=="},{value:"${1}",operator:"!=",label:"!="},{value:"${1}",operator:">",label:">"},{value:"${1}",operator:">=",label:">="},{value:"${1}",operator:"<=",label:"<="},{value:"${1}",operator:"<",label:"<"}],u=[{value:"",operator:"",label:""},{value:"${1}",operator:"=",label:"=="},{value:"${1}",operator:"!=",label:"!="},{value:"${1}",operator:">",label:">"},{value:"${1}",operator:">=",label:">="},{value:"${1}",operator:"<=",label:"<="},{value:"${1}",operator:"<",label:"<"}],g=function(){function e(){this.value="",this.changeOperator=new t.EventEmitter,this.changeEmptyOperator=new t.EventEmitter,this.options=null,this.multiple=!1,this.isRowHTML=!1,this.values=[],this.label="",this.popupPosition={top:0,left:0}}return e.prototype.getFuncClickDocument=function(){var e=this,t=function(){e.elemToggle.nativeElement.style.display="none",s(document).off("click",t)};return t},e.prototype.toggleDiv=function(){var e=this.getFuncClickDocument();if(s(document).off("click",e),"none"==this.elemToggle.nativeElement.style.display){this.elemToggle.nativeElement.style.display="block";this.elemValue.nativeElement.parentElement;setTimeout((function(){s(document).on("click",e)}),500)}else this.elemToggle.nativeElement.style.display="none",s(document).off("click",e)},e.prototype.ngOnInit=function(){if(this.isRowHTML=this.col.isRowHTML,"string"==this.col.dataType&&(this.options=d),"boolean"==this.col.dataType&&(this.multiple=!0,this.options=c),"bool"==this.col.dataType&&(this.multiple=!0,this.options=p),"number"!=this.col.dataType&&"float"!=this.col.dataType||(this.options=h),"date"==this.col.dataType&&(this.options=u),"selector"==this.col.dataType&&(this.options=[]),this.col.headFilter&&(this.options=this.col.headFilter,this.multiple=!0),null==this.options)throw"Bad definition to operator "+this.col.prop;for(var e in this.options)this.options[e].checked=!1},e.prototype.setFirstChoice=function(){if(console.log("mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm"),!1===this.multiple&&""==this.label)for(var e in this.options)if(""!=this.options[e].label)return void this.changeValue(this.options[e],!0)},e.prototype.getOperator=function(){var e=this;return!1===this.multiple?""==this.value?null:this.options.find((function(t){return t.value===e.value&&1==t.checked})):null},e.prototype.changeValues=function(e){for(var t in e.checked?e.checked=!1:e.checked=!0,this.values.splice(0),this.options)!0===this.options[t].checked&&this.values.push(this.options[t]);this.label="("+this.values.length+")",0==this.values.length&&(this.label=""),this._changeOperator()},e.prototype.getConditions=function(e){if(0==this.multiple){var t=this.getOperator();if(null!=t&&""!=t.operator){var i=t.value.replace("${1}",e);return[this.col.prop,t.operator,i]}}else if(this.values.length>0){for(var a=[],r=0;r<this.values.length;r++){var n=this.values[r].value;a.push([this.col.prop,this.values[r].operator,n]),this.values.length-1>r&&a.push("or")}return a}return null},e.prototype.changeValue=function(e,t){console.log("CHANGES VALUES",e),this.options.find((function(e){return!0===e.checked}))&&(this.options.find((function(e){return!0===e.checked})).checked=!1),e.checked?e.checked=!1:e.checked=!0,e.label.match(/^\s+$/)?(this.value="",this.label=""):(this.value=e.value,this.label=e.label),t||this.toggleDiv(),this._changeOperator(),""==e.operator&&this.changeEmptyOperator.emit()},e.prototype._changeOperator=function(){this.changeOperator.emit({prop:this.col})},e}();g.decorators=[{type:t.Component,args:[{selector:"ma-data-grid-op-filter",template:'\x3c!--\n<div class="red">=</div>(onComplete)="onComplete($event)"\n\n<app-ma-completion [data]="choices" placeholder="" value="defautValue"  ></app-ma-completion>\n     <select dir="rtl">\n    <option>Foo</option>    \n    <option>bar</option>\n    <option>to the right</option>\n</select>\n\n\n<div *ngIf="col.isRowNumber === true; then RowNumberBlock else dataBlock"></div>\n<ng-template #RowNumberBlock>{{i}}</ng-template>\n<ng-template #dataBlock> {{u[col.prop] | dataGridPipe :u :c}}</ng-template>\n--\x3e\n\n<div>\n\n    <div #elemValue (click)="toggleDiv()" class="op_label"><i *ngIf="label == \'\'" class="tiny material-icons">search</i>{{label}}\n    </div>\n    \x3c!-- [style.left.px]="popupPosition.left"  [style.top.px]="popupPosition.top"--\x3e\n    <div #elemToggle style="display: none; position: absolute; z-index: 20; max-height: 300px; overflow-y: auto; background-color: aliceblue;border: 1px solid #9e9e9e;">\n        <div *ngFor="let opt of options;" class="op_filter" [value]="opt.value">\n            <div *ngIf="multiple === true">\n                <label>\n                    <input type="checkbox" class="op_filter" [value]="opt.value" [checked]="opt.checked" (click)="changeValues(opt)" />\n                    <span *ngIf="!isRowHTML">{{opt.label}}</span>\n                    <span *ngIf="isRowHTML === true" [innerHTML]="opt.label"></span>\n                </label>\n            </div>\n            <div *ngIf="multiple === false">\n                <div (click)="changeValue(opt)">{{opt.label}}&nbsp;</div>\n            </div>\n        </div>\n    </div>\n\n</div>\n\x3c!--\n<select class="browser-default op_filter" [(ngModel)]="value" (change)="_changeOperator($event)" >\n    <option *ngFor="let opt of options;"  class="op_filter" [value]="opt.value">{{opt.label}}\n    </option>\n</select>\n\n\n--\x3e',styles:["select.op_filter{border:1px inset #9e9e9e;height:1.4rem;min-width:25px;padding:0}.op_filter{border-top:1px solid #9e9e9e;padding-left:10px;padding-right:10px}.op_filter,.op_label{font-weight:lighter}"]}]}],g.ctorParameters=function(){return[]},g.propDecorators={value:[{type:t.Input}],col:[{type:t.Input}],elemToggle:[{type:t.ViewChild,args:["elemToggle",{static:!1}]}],elemValue:[{type:t.ViewChild,args:["elemValue",{static:!1}]}],changeOperator:[{type:t.Output}],changeEmptyOperator:[{type:t.Output}]};var m=function(){function e(){this.datevalue=null,this.realValue="",this.time="",this.value="",this.changePicker=new t.EventEmitter,this.datepicker_id="dp_"+Math.floor(1e5*Math.random())}return e.prototype.ngAfterViewInit=function(){this._init()},e.prototype.ngOnDestroy=function(){this.instance&&this.instance.destroy()},e.prototype.ngOnInit=function(){""==this.value&&(this.datevalue=null)},e.prototype.getDate=function(){return this.datevalue},e.prototype.setDate=function(e){if(null!=e){var t=(new Date).getTimezoneOffset();e=new Date(e.getTime()-60*t*1e3)}var i=document.getElementById(this.datepicker_id);i.value=null==e?"":e.toISOString().replace(/T.+/,""),this.datevalue=e},e.prototype.getTime=function(){return this.time},e.prototype.setTime=function(e,t){e<10&&(e="0"+e),t<10&&(t="0"+t),this.time=e+":"+t},e.prototype._init=function(){var e=document.getElementById(this.datepicker_id),t=this;if("date"==this.type){a.Datepicker.init(e,{autoClose:!0,format:"yyyy-mm-dd",onSelect:function(e){t.setDate(e)}});e.onchange=function(i){""!=e.value&&e.value.match(/^\d\d\d\d-\d\d-\d\d$/)||(e.value="",t.setDate(null)),t.emitDateEvent()}}else a.Timepicker.init(e,{autoClose:!0,twelveHour:!1,onSelect:function(e,i,a){t.setTime(e,i),t.emitTimeEvent()}})},e.prototype.onChange=function(){"date"==this.type?this.changePicker.emit(this.datevalue):this.changePicker.emit(this.time)},e.prototype.emitDateEvent=function(){this.changePicker.emit(this.datevalue)},e.prototype.emitTimeEvent=function(){this.changePicker.emit(this.time)},e}();m.decorators=[{type:t.Component,args:[{selector:"ma-data-grid-datepicker",template:'\n    \x3c!-- [(ngModel)]="realValue"   --\x3e\n    <input \n        [id]="datepicker_id" \n        #madatepicker type="text" \n        [(ngModel)]="realValue"\n        class="ma-data-grid-datepicker datepicker">\n\n',styles:[""]}]}],m.ctorParameters=function(){return[]},m.propDecorators={value:[{type:t.Input}],type:[{type:t.Input}],changePicker:[{type:t.Output}],madatepicker:[{type:t.ViewChild,args:["madatepicker",{static:!1}]}]};var f=function(){function e(){this.filter_value="",this.changeHeaderFilter=new t.EventEmitter,this.astuce_datapicker="display: none"}return e.prototype.ngOnInit=function(){"date"==this.col.dataType&&(this.astuce_datapicker="display: block")},e.prototype.getFilter=function(){return""!=this.filter_value||"boolean"==this.col.dataType||"bool"==this.col.dataType||null!=this.col.headFilter?this.op_filter.getConditions(this.filter_value):null},e.prototype._changeEmptyOperator=function(){this.madate_picker.setDate(null)},e.prototype._changeOperator=function(e,t){console.log("RECEIVE CHANGE OP",this.col),t&&this.op_filter.setFirstChoice(),this.changeHeaderFilter.emit({prop:this.col,value:this.filter_value})},e.prototype._changeDate=function(e){this.filter_value="";try{this.filter_value=e.toISOString()}catch(e){}this.changeHeaderFilter.emit({prop:this.col,value:this.filter_value})},e}();f.decorators=[{type:t.Component,args:[{selector:"ma-data-grid-head-filter",template:'<table >\n    <tr>\n        <td class="header_filter_op" *ngIf="col.filter !== false">\n            <ma-data-grid-op-filter #op_filter [col]="col" (changeEmptyOperator)="_changeEmptyOperator()" (changeOperator)="_changeOperator($event,false)"></ma-data-grid-op-filter>\n        </td>\n        <td class="header_filter" *ngIf="col.filter !== false && col.dataType != \'date\' && col.dataType != \'bool\' && col.dataType != \'boolean\' && (!col.headFilter || col.headFilter.length == 0)">\n            <input class="header_filter" [(ngModel)]="filter_value" (keyup)="_changeOperator($event,true)" />\n        </td>\n        <td class="header_filter" *ngIf="col.filter !== false" [style]="astuce_datapicker" >\n            <ma-data-grid-datepicker #madate_picker type="date" (changePicker)="_changeDate($event)"></ma-data-grid-datepicker>\n        </td>\n    </tr>\n</table>',styles:["input.header_filter{background-color:#e8f5f8;border:1px inset #9e9e9e;height:1.2rem;margin:0 0 0 -5px}/deep/ .ma-data-grid-datepicker{height:1.2rem;max-height:1.2rem}td.header_filter{padding:1px 1px 1px 5px}td.header_filter_op{padding:1px 1px 1px 0}"]}]}],f.ctorParameters=function(){return[]},f.propDecorators={filter_value:[{type:t.Input}],col:[{type:t.Input}],changeHeaderFilter:[{type:t.Output}],op_filter:[{type:t.ViewChild,args:[g,{static:!0}]}],madate_picker:[{type:t.ViewChild,args:[m,{static:!0}]}]};Object.create;function y(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],a=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}Object.create;var v=function(){function e(){this.placeholder="Enter filter",this.customCSS="",this.searchValueChange=new t.EventEmitter,this.columns=[],this.filterChange=new t.EventEmitter,this.input_filter="if_"+Math.floor(1e5*Math.random()),this.filters=[],this.selectedFields=[]}return e.prototype.ngOnChanges=function(e){this._init(),e.searchValue&&s("#"+this.input_filter).val(e.searchValue.currentValue)},e.prototype._init=function(){var e,t;this.filters=[],this.selectedFields=[];try{for(var i=y(this.columns),a=i.next();!a.done;a=i.next()){var r=a.value;!0===r.extFilter&&(r.extFilterSelected&&this.selectedFields.push(r.prop),this.filters.push(Object.assign(r)))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this.enableFocus()},e.prototype.ngOnInit=function(){this._init(),a.updateTextFields()},e.prototype.clickChekbox=function(e){e.extFilterSelected=!e.extFilterSelected,this._init(),this.updateFilter(null)},e.prototype.enableFocus=function(){this.selectedFields.length>0?s("#"+this.input_filter).focus():s("#"+this.input_filter).blur()},e.prototype.updateFilter=function(e){var t=s("#"+this.input_filter).val();this.searchValue=t,this.searchValueChange.emit(this.searchValue);var i={text:t,fields:this.selectedFields};this.filterChange.emit(i)},e}();v.decorators=[{type:t.Component,args:[{selector:"ma-data-grid-filter",template:'<div class="row ma-grid-filter">\n    <div class="input-field col s3"  >\n        <i (click)="enableFocus()" class="material-icons prefix">search</i>\n          <input [id]="input_filter" type="text" class="validate" (keyup)="updateFilter($event)">\n          <label for="icon_prefix">{{placeholder}}</label>\n    </div>\n    <div class="col s8 {{customCSS}}ma-grid-filter-checkboxes">\n        <div class="title_field"> Select column(s) filter</div>\n        \x3c!--  [disabled]="selectedFields.length == 0"\n<span *ngFor="let col of columns"> {{col.prop}} | </span>\n[(ngModel)]="col.extFilterSelected" \n[ngClass]="{\'disabled\':selectedFields.length >= 0}"\n        --\x3e\n        <div class="checkbox_field" *ngFor="let col of filters;last as isLast;index as i;">\n            <label *ngIf="col.extFilter === true">\n                <input type="checkbox" [checked]="col.extFilterSelected" (click)="clickChekbox(col)" />\n                <span class="checkbox_title">{{col.title}}</span>\n                <span *ngIf="!isLast" class="checkbox_separator">|</span>\n            </label>\n        </div>\n    </div>\n</div>\n',styles:[':host{--border-size:0px;--color-border:#667;--color-defaut:#667}.ma-grid-filter .ma-grid-filter-checkboxes{border:1px solid var(--color-border);color:var(--color-defaut);margin-right:10px}.ma-grid-filter .title_field{font-weight:500;margin-left:15px}.ma-grid-filter .checkbox_field{display:inline;margin-left:5px;margin-right:5px}.ma-grid-filter span.checkbox_title{min-width:70px;padding-left:22px}.ma-grid-filter span.checkbox_title:after{content:"|"}.ma-grid-filter span.checkbox_separator{font-size:large;margin-left:5px}']}]}],v.ctorParameters=function(){return[]},v.propDecorators={searchValue:[{type:t.Input}],customCSS:[{type:t.Input}],searchValueChange:[{type:t.Output}],columns:[{type:t.Input}],filterChange:[{type:t.Output}]};var _=function(){function e(){this.columns=[],this.limit=7,this.extFilter=!1,this.headFilter=!1,this.pagination=!1,this.page=-1,this.count=0,this.customCSS="",this.myGrid=this,this.rows=[],this.change=new t.EventEmitter,this.select=new t.EventEmitter,this.extFilterChange=new t.EventEmitter,this.filterChange=new t.EventEmitter,this.changePage=new t.EventEmitter,this.sort=new t.EventEmitter,this.canSelectChange=new t.EventEmitter,this.rowsChange=new t.EventEmitter,this.rowsSelect=new t.EventEmitter,this.grid_cell_first=this.customCSS+"grid_cell_first",this.grid_row_selected=this.customCSS+"grid_row_selected",this.current_page=-1,this.max_page=1,this.max_nb_page=6,this.nb_page=1,this.startat=0,this.searchValue="c",this.rows_displayed=[],this.pages=[],this.conditions=[],this.nb_record=0,this.row_selected=-1,this.cell_selected=-1,this.sortedField={field:"",reverse:!0},this.timeout=null}return e.prototype.resetSelection=function(){this.cell_selected=-1,this.row_selected=-1},e.prototype.ngOnChanges=function(e){console.log("ngOnChanges ",e),e.page&&e.page.currentValue,e.canSelect&&e.canSelect.currentValue&&this.canSelectChange.emit(e.canSelect.previousValue),e.limit&&e.limit.currentValue&&(this.limit=e.limit.currentValue),e.rows&&e.rows.currentValue&&(this.temp=e.rows.currentValue,this._changePage(this.current_page,this.temp,!0))},e.prototype.IncrementPage=function(){this._changePage(this.current_page+1,this.temp)},e.prototype.DecrementPage=function(){this._changePage(this.current_page-1,this.temp)},e.prototype.FastIncrementPage=function(){var e=this.current_page+5;this._changePage(e,this.temp)},e.prototype._dataChange=function(e){console.log("_dataChange",e),this.rowsChange.emit(e)},e.prototype._dataSelector=function(e,t){console.log("_dataSelector",e,t),this.rowsSelect.emit(e)},e.prototype.FastDecrementPage=function(){var e=this.current_page-5;this._changePage(e,this.temp)},e.prototype._changePage=function(e,t,i){if(t||(t=this.temp),0==this.pagination&&(!0===i&&(this.temp=r.MaFilter.FilterByConditions(this.conditions,t),this.temp=this._sortData(this.temp),t=this.temp),this.count=t.length),this.max_page=0,this.count>=0&&this.limit>0&&(this.max_page=Math.floor(this.count/this.limit),this.count%this.limit!=0&&(this.max_page+=1)),e<0&&(e=0),e>=this.max_page&&this.max_page>0&&(e=this.max_page-1),this.page>=0||this.pagination){if(this.current_page!=e)return this.current_page=e,this.searchValue="",void this.changePage.emit(e);this.row_selected=-1,this.current_page=e,this.nb_record=this.count,this.startat=0,this.rows_displayed=[];for(var a=0;t&&a<this.limit&&a<this.count&&a<t.length;a++)this.rows_displayed.push(t[a])}else{if(!i&&this.current_page==e)return;this.row_selected=-1,this.current_page=e,this.nb_record=0,this.startat=0,this.rows_displayed=[];for(a=0;t&&a<this.limit&&a<t.length;a++)t.length>this.current_page*this.limit+a&&this.rows_displayed.push(t[this.current_page*this.limit+a]);this.nb_record=t.length}this.startat=this.limit*(this.current_page+1),this.startat>this.count&&(this.startat=this.count),this.pages=[];var n=this.current_page-Math.round(this.max_nb_page/2);n<0&&(n=0);for(var o=n,l=0;t&&o<this.count/this.limit&&l<this.max_nb_page;l++,o++)this.pages.push(o)},e.prototype.ngOnInit=function(){},e.prototype._sortData=function(e){var t=this,i=this.sortedField.field;return e.sort((function(e,a){var r;if("string"==typeof e[i]||"string"==typeof a[i]){var n=e[i],o=a[i];null==o&&(o=""),null==n&&(n=""),r=n.localeCompare(o,"en",{sensitivity:"base"})}else if("number"==typeof e[i]||"number"==typeof a[i])r=e[i]-a[i];else if("boolean"==typeof e[i]||"boolean"==typeof a[i]){var l=0;!0===e[i]&&(l=2),!1===e[i]&&(l=1);var s=0;!0===a[i]&&(s=2),!1===a[i]&&(s=1),r=l-s}else r=e[i]<a[i];return t.sortedField.reverse?-1*r:r}))},e.prototype.sortBy=function(e){this.sortedField.field==e.prop?this.sortedField.reverse=!this.sortedField.reverse:this.sortedField.reverse=!1,this.sortedField.field=e.prop,this.pagination?this.sort.emit(this.sortedField):this._changePage(this.current_page,this.rows,!0)},e.prototype.SelectRow=function(e,t){if("row"===this.canSelect){this.row_selected=e,this.cell_selected=null;var i=this.current_page*this.limit+e;this.select.emit({index:i,row:t})}},e.prototype.SelectCell=function(e,t,i){if("cell"===this.canSelect){this.row_selected=e,this.cell_selected=i.prop;var a=this.current_page*this.limit+e;this.select.emit({index:a,row:t,prop:i.prop,value:t[i.prop]})}},e.prototype._filterChange=function(e){this.extFilterChange.emit(e)},e.prototype._changeHeaderFilter=function(e){var t=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){t._delayChangeHeaderFilter(e)}),500)},e.prototype._delayChangeHeaderFilter=function(e){var t=[];this.headerfilter.forEach((function(e){var i=e.getFilter();i&&(t.length>0&&t.push("and"),t.push(i))})),0==this.pagination?(this.conditions=t,this._changePage(0,this.rows,!0),this.filterChange.emit({where:t,data:this.temp})):this.filterChange.emit({where:t})},e}();_.decorators=[{type:t.Component,args:[{selector:"ma-data-grid",template:'\x3c!-- #gridfilter *ngIf="extFilter" --\x3e\r\n<ma-data-grid-filter #gridfilter *ngIf="extFilter" [customCSS]="customCSS"  [(searchValue)]="searchValue" [columns]="columns"  (filterChange)="_filterChange($event)"></ma-data-grid-filter>\r\n<div class="datagrid_page">\r\n    <div class="scroller">\r\n        <table class="{{customCSS}}grid_table">\r\n            \x3c!-- HEADER --\x3e\r\n            <tr class="grid_row">\r\n                <td class="{{customCSS}}grid_cell {{customCSS}}grid_cell_title"  [ngClass]="{grid_cell_first: i==0}" *ngFor="let col of columns;index as i; ">\r\n                    <datagrid-cellheader-container [ngSwitch]="true"  >\r\n                        <datagrid-cell-element *ngSwitchCase="col.dataType == \'selector\'"><ma-data-grid-cell-selector [prop]="col.prop" [isHeader]="true" [col]="col" [myGrid]="myGrid" [data]="rows_displayed"></ma-data-grid-cell-selector><span>{{col.title}}</span></datagrid-cell-element>\r\n                        <datagrid-cell-element *ngSwitchDefault >{{col.title}}</datagrid-cell-element>\r\n                    </datagrid-cellheader-container>\r\n                    \r\n                    <span *ngIf="col.dataType != \'selector\' && col.isRowNumber !== true && col.sorted === true" (click)="sortBy(col)">\r\n                        <span *ngIf="sortedField.field != col.prop" class="grid_sort tiny material-icons">swap_vert</span>\r\n                        <span *ngIf="sortedField.field === col.prop && sortedField.reverse" class="grid_sort tiny material-icons">arrow_drop_down</span>\r\n                        <span *ngIf="sortedField.field === col.prop && !sortedField.reverse" class="grid_sort tiny material-icons">arrow_drop_up</span>\r\n                    </span> \r\n                </td>\r\n            </tr>\r\n            \x3c!-- Head Filter --\x3e\r\n            <tr class="{{customCSS}}grid_row" *ngIf="headFilter">\r\n                <td class="{{customCSS}}grid_cell {{customCSS}}grid_cell_title"  [ngClass]="{grid_cell_first: i==0}" *ngFor="let col of columns;index as i; ">\r\n                    <ma-data-grid-head-filter #headerfilter *ngIf="(col.dataType && col.dataType != \'selector\' &&  col.headFilter !== false) || (col.headFilter !== false && col.headFilter != null  && col.headFilter.length > 0)" [col]="col" (changeHeaderFilter)="_changeHeaderFilter($event)"></ma-data-grid-head-filter>\r\n                </td>\r\n            </tr>\r\n            \x3c!-- DATA --\x3e\r\n            <tr class="{{customCSS}}grid_row" *ngFor="let row of rows_displayed; \r\n                    last as isLastRow; \r\n                    even as pair; \r\n                    index as i; \r\n                    first as isFirstRow"\r\n                (click)="SelectRow(i,row)" [ngClass]="{\'grid_row_selected\': i == row_selected && !cell_selected, \'CSSclassEven\': pair,\'CSSclassOdd\': !pair, \'grid_row_first\': isFirstRow, \'grid_row_end\': isLastRow}">\r\n    \r\n                <td class="{{customCSS}}grid_cell {{col.cssClass}}" *ngFor="let col of columns; \r\n                    index as ncol; \r\n                    count as maxcol; \r\n                    first as isFirstCol\r\n                    last as isLastCol;" \r\n                    \r\n                    [ngClass]="{\'grid_cell_selected\': i == row_selected && col.prop == cell_selected, \'grid_cell_end\': isLastCol,\'grid_cell_first\': isFirstCol}"\r\n                    (click)="SelectCell(i,row,col)">\r\n                    \x3c!--  {{col.prop}} représente le nom de colonne d\'un élément contenu dans \'colmuns\' -- >\r\n                    <div *ngIf="col.isRowNumber === true; then RowNumberBlock else dataBlock"></div>\r\n                    <ng-template #RowNumberBlock>{{i}}</ng-template>\r\n                    <ng-template #dataBlock> {{u[col.prop] | dataGridPipe :u :c}}</ng-template>\r\n                    --\x3e\r\n                    <datagrid-cell-container [ngSwitch]="true"  >\r\n                        <datagrid-cell-element *ngSwitchCase="col.dataType == \'selector\'" ngSwitchBreak><ma-data-grid-cell-selector [prop]="col.prop" [col]="col" [myGrid]="myGrid" [data]="row"></ma-data-grid-cell-selector></datagrid-cell-element>\r\n                        <datagrid-cell-element *ngSwitchCase="col.useTemplate != null" ngSwitchBreak><ma-data-grid-template-cell-t1 [template]="col.useTemplate" [prop]="col.prop" [col]="col" [myGrid]="myGrid" [data]="row"></ma-data-grid-template-cell-t1></datagrid-cell-element>\r\n                        <datagrid-cell-element *ngSwitchCase="col.canEdit === true" ngSwitchBreak><ma-data-grid-celledit-item [prop]="col.prop" [col]="col" [myGrid]="myGrid" [data]="row"></ma-data-grid-celledit-item></datagrid-cell-element>\r\n                        <datagrid-cell-element *ngSwitchCase="col.isRowNumber === true" ngSwitchBreak>{{i}}</datagrid-cell-element>\r\n                        <datagrid-cell-element *ngSwitchCase="col.isRowHTML === true" ngSwitchBreak><span [innerHTML]="row[col.prop]"></span></datagrid-cell-element>\r\n                        <datagrid-cell-element *ngSwitchCase="col.useTemplate == null && col.canEdit !== true && (col.dataType == \'boolean\' || col.dataType == \'bool\')" ngSwitchBreak><ma-data-grid-cell-boolean [col]="col" [data]="row"></ma-data-grid-cell-boolean></datagrid-cell-element>\r\n                        <datagrid-cell-element *ngSwitchDefault>{{row[col.prop] | maDataGridPipe :row :col}}</datagrid-cell-element>\r\n                    </datagrid-cell-container>\r\n                </td>\r\n        \r\n            </tr>\r\n        </table>\r\n        \r\n    </div>\r\n    <div class="row" style="padding-top: 5px;">\r\n        <div class="col s3 ">\r\n            <div class="page_number">#{{nb_record}} record<span *ngIf="nb_record > 1">s</span></div>\r\n        </div>\r\n        <div class="col s8 div_pagination">\r\n           \r\n            <ul class="pagination">\r\n                <li *ngIf="max_page >= 9" (click)="FastDecrementPage()" [ngClass]="{\'disabled\': current_page == 0,\'\': current_page != 0}"><a  class="pointer"><i class="material-icons small">fast_rewind</i></a></li>\r\n                <li *ngIf="nb_record > 0" (click)="DecrementPage()" [ngClass]="{\'disabled\': current_page == 0,\'\': current_page != 0}"><a  class="pointer"><i class="material-icons small">chevron_left</i></a></li>\r\n                <li *ngFor="let n_page of pages" (click)="_changePage(n_page)" [ngClass]="{\'active\': current_page == n_page,\'\': current_page != n_page}" ><a class="pointer" class="a_pagination small ">{{(n_page+1)}}</a></li>\r\n                <li *ngIf="nb_record > 0" (click)="IncrementPage()" [ngClass]="{\'disabled\': current_page == max_page,\'\': current_page != max_page}"><a  class="pointer"><i class="material-icons small">chevron_right</i></a></li>\r\n                <li *ngIf="max_page >= 9" (click)="FastIncrementPage()" [ngClass]="{\'disabled\': current_page == max_page,\'\': current_page != max_page}"><a class="pointer"><i class="material-icons small">fast_forward</i></a></li>\r\n            </ul>\r\n       \r\n        </div>\r\n    </div>\r\n</div>\r\n    \r\n    ',styles:[":host{--color-border:#667;--color-defaut:#667}.datagrid_page .CSSclassOdd{background-color:#ddd}.datagrid_page{height:100%;width:100%}.div_pagination .pointer{cursor:default}.div_pagination .page_number{color:var(--color-defaut);font-size:1rem;padding:0 10px}.datagrid_page .div_pagination{display:-ms-inline-grid;display:inline-grid;justify-content:flex-end}.a_pagination:hover,.div_pagination .a_pagination{color:var(--color-border);display:inline-block;font-size:1rem;line-height:30px;padding:0 10px;text-decoration:none}.datagrid_page .scroller{-ms-grid-row-align:center;align-self:center;background-color:#fefefe;overflow:auto;scrollbar-color:var(--color-border) #fefefe;scrollbar-width:auto;width:100%}.grid_table .grid_row_selected{background-color:#667;color:#ddd}.grid_table .grid_sort{cursor:pointer}.datagrid_page .grid_table{width:100%}.grid_table .grid_cell_title{border-top:1px solid var(--color-border);color:var(--color-defaut);font-weight:700;text-align:center}.grid_table .grid_cell_selected{background-color:#667;color:#ddd}.grid_table .grid_cell_first{border-left:10px solid var(--color-border)}.grid_table .grid_cell_end{border-right:0 solid var(--color-border)}.grid_table .grid_cell{border-right:1px solid var(--color-border)}.grid_table .grid_row_first{border-bottom:1px solid var(--color-border)}.grid_table .grid_row_last{border-bottom:0 solid var(--color-border)}.grid_table .grid_row{border-bottom:1px solid var(--color-border)}"]}]}],_.ctorParameters=function(){return[]},_.propDecorators={columns:[{type:t.Input}],limit:[{type:t.Input}],canSelect:[{type:t.Input}],extFilter:[{type:t.Input}],headFilter:[{type:t.Input}],pagination:[{type:t.Input}],page:[{type:t.Input}],count:[{type:t.Input}],customCSS:[{type:t.Input}],myGrid:[{type:t.Input}],rows:[{type:t.Input}],change:[{type:t.Output}],select:[{type:t.Output}],extFilterChange:[{type:t.Output}],filterChange:[{type:t.Output}],changePage:[{type:t.Output}],sort:[{type:t.Output}],canSelectChange:[{type:t.Output}],rowsChange:[{type:t.Output}],rowsSelect:[{type:t.Output}],gridfilter:[{type:t.ViewChild,args:[v,{static:!0}]}],headerfilter:[{type:t.ViewChildren,args:[f]}]};var b=function(e){this.viewContainerRef=e};b.decorators=[{type:t.Directive,args:[{selector:"[libMaAnchorGridCell]"}]}],b.ctorParameters=function(){return[{type:t.ViewContainerRef}]};var w=function(e){this.viewContainerRef=e};w.decorators=[{type:t.Directive,args:[{selector:"[libMaGridCellTemplate]"}]}],w.ctorParameters=function(){return[{type:t.ViewContainerRef}]};var C=function(e,t,i,a,r){this.component=e,this.data=t,this.col=i,this.prop=a,this.myGrid=r},x=function(){function e(e){this.componentFactoryResolver=e}return e.prototype.ngOnInit=function(){var e;if(this.template){var i=new C(this.template,this.data,this.col,this.prop,this.myGrid),a=this.componentFactoryResolver.resolveComponentFactory(i.component);if(this.libMaGridCellTemplate){var r=this.libMaGridCellTemplate.viewContainerRef.createComponent(a);r.instance.data=i.data,r.instance.prop=i.prop,r.instance.col=i.col,r.instance.dataChange=new t.EventEmitter,r.instance.myGrid=i.myGrid,null===(e=r.instance.dataChange)||void 0===e||e.subscribe((function(e){null!=r.instance.myGrid&&r.instance.myGrid._dataChange(e)}))}}},e}();x.decorators=[{type:t.Component,args:[{selector:"ma-data-grid-template-cell-t1",template:"<ng-template libMaGridCellTemplate></ng-template>"}]}],x.ctorParameters=function(){return[{type:t.ComponentFactoryResolver}]},x.propDecorators={data:[{type:t.Input}],prop:[{type:t.Input}],col:[{type:t.Input}],template:[{type:t.Input}],myGrid:[{type:t.Input}],dataChange:[{type:t.Output}],libMaGridCellTemplate:[{type:t.ViewChild,args:[w,{static:!0}]}]};var k=function(){function e(){}return e.prototype.transform=function(e,t,i){return i.pipe?i.pipe(e,t,i):e},e}();k.decorators=[{type:t.Pipe,args:[{name:"maDataGridPipe"}]}];var I=function(){function e(){this.icon=""}return e.prototype.ngOnInit=function(){},e}();I.decorators=[{type:t.Component,args:[{selector:"ma-data-grid-cell-boolean",template:'<div style="text-align: center"><i *ngIf="data[col.prop] === true" class="tiny material-icons">check_box</i><i *ngIf="data[col.prop] === false" class="tiny material-icons">check_box_outline_blank</i></div>'}]}],I.ctorParameters=function(){return[]},I.propDecorators={data:[{type:t.Input}],col:[{type:t.Input}]};var S=function(){function e(){this.value="",this.dataChange=new t.EventEmitter}return e.prototype.ngOnInit=function(){this.col&&"boolean"==this.col.dataType&&(!this.data||1!=this.data[this.prop]&&1!=this.data[this.prop]&&"on"!=this.data[this.prop]||(this.data[this.prop]=!0))},e.prototype.onPress=function(e){console.log(e),"Enter"==e.Key&&this.onChange()},e.prototype.onChange=function(){var e=!0;if(this.col&&"number"==this.col.dataType)this.myInput.nativeElement.value.match(/^[0-9]+$/)?this.data[this.prop]=parseInt(this.myInput.nativeElement.value):(e=!1,this.myInput.nativeElement.value=this.data[this.prop]);else if(this.col&&"float"==this.col.dataType){this.myInput.nativeElement.value.match(/^[0-9]+\.{0,1}[0-9]*$/)?this.data[this.prop]=parseFloat(this.myInput.nativeElement.value):(e=!1,this.myInput.nativeElement.value=this.data[this.prop])}else if(this.col&&"date"==this.col.dataType)try{var t=new Date(this.myInput.nativeElement.value).toISOString().replace(/T.+/,"");this.data[this.prop]=t}catch(t){e=!1,this.myInput.nativeElement.value=this.data[this.prop]}else!this.col||"boolean"!=this.col.dataType&&"bool"!=this.col.dataType?this.data[this.prop]=this.myInput.nativeElement.value:this.data[this.prop]=this.myInput.nativeElement.checked;e&&(this.dataChange.emit(this.data),null!=this.myGrid&&this.myGrid._dataChange(this.data))},e.prototype.onChangeCheckbox=function(){this.data[this.prop]=this.myInputCheckbox.nativeElement.checked,this.dataChange.emit(this.data),null!=this.myGrid&&this.myGrid._dataChange(this.data)},e.prototype.ngOnChanges=function(e){},e}();S.decorators=[{type:t.Component,args:[{selector:"ma-data-grid-celledit-item",template:'<div *ngIf="!col || col.dataType != \'boolean\'">\n    \x3c!-- (keyup)="onChange()" (keypress)="onPress($Event)" --\x3e\n    <input #myInput type="text" [(value)]="data[prop]" (keypress)="onPress($event)" (change)="onChange()">\n</div>\n<div *ngIf="col && col.dataType == \'boolean\'">\n    <label>\n        <input #myInputCheckbox type="checkbox" [(ngModel)]="data[col.prop]" (change)="onChangeCheckbox()" />\n        <span></span>\n    </label>\n</div>',styles:[""]}]}],S.ctorParameters=function(){return[]},S.propDecorators={myInput:[{type:t.ViewChild,args:["myInput",{static:!1}]}],myInputCheckbox:[{type:t.ViewChild,args:["myInputCheckbox",{static:!1}]}],dataChange:[{type:t.Output}],data:[{type:t.Input}],col:[{type:t.Input}],prop:[{type:t.Input}],myGrid:[{type:t.Input}]};var F=function(){function e(){this.title="",this.dataChange=new t.EventEmitter,this.isHeader=!1}return e.prototype.ngOnInit=function(){this.isHeader?this.title=this.col.title:this.title="",!this.data||1!=this.data[this.prop]&&1!=this.data[this.prop]&&"on"!=this.data[this.prop]||(this.data[this.prop]=!0)},e.prototype.onChangeCheckbox=function(){var e,t;if(this.isHeader)try{for(var i=y(this.data),a=i.next();!a.done;a=i.next()){a.value[this.prop]=this.myInputSelectorBox.nativeElement.checked}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}else this.data[this.prop]=this.myInputSelectorBox.nativeElement.checked;this.dataChange.emit(this.data),null!=this.myGrid&&this.myGrid._dataSelector(this.data,this.prop)},e.prototype.ngOnChanges=function(e){},e}();F.decorators=[{type:t.Component,args:[{selector:"ma-data-grid-cell-selector",template:'<span>\n    \x3c!--  [(ngModel)]="realValue" [checked]="checked" --\x3e\n    <label>\n        <input [(ngModel)]="data[col.prop]" #myInputSelectorBox type="checkbox"  (change)="onChangeCheckbox()" />\n        <span></span>\n    </label>\n</span>',styles:[""]}]}],F.ctorParameters=function(){return[]},F.propDecorators={myInputSelectorBox:[{type:t.ViewChild,args:["myInputSelectorBox",{static:!1}]}],dataChange:[{type:t.Output}],data:[{type:t.Input}],isHeader:[{type:t.Input}],col:[{type:t.Input}],prop:[{type:t.Input}],myGrid:[{type:t.Input}]};var E=function(){};E.decorators=[{type:t.NgModule,args:[{declarations:[_,b,x,k,v,f,g,m,I,w,S,F],imports:[n.CommonModule,o.FormsModule],exports:[_,v]}]}],e.MaDataGridComponent=_,e.MaDataGridModule=E,e.MaGridFilterComponent=v,e.options_header_bool=p,e.options_header_boolean=c,e.options_header_date=u,e.options_header_number=h,e.options_header_string=d,e.ɵa=f,e.ɵb=g,e.ɵc=m,e.ɵd=b,e.ɵe=x,e.ɵf=w,e.ɵg=k,e.ɵh=I,e.ɵi=S,e.ɵj=F,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=amn31-ma-data-grid.umd.min.js.map